###############################################################
# General Options
###############################################################
# enable 256 color support
set -g  default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# scrollback size
set -g history-limit 20000

# automatically renumber windows
set -g renumber-windows on

# set first window to index 1 (not 0)
set -g base-index 1
set -g pane-base-index 1

# enable mouse support
set -g mouse on

# make ESC delay shorter
set -sg escape-time 0

# enable xterm key sequences
set-option -w -g xterm-keys on

# change prefix from [ctrl+b] to [ctrl+<space>]
unbind C-b
set -g prefix C-Space

###############################################################
# Keybinds
###############################################################
# stay in copy mode on mouse drag end event
unbind-key -T copy-mode-vi MouseDragEnd1Pane

# yank selected text to Windows clipboard (breaks on non-WSL distros)
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel clip.exe \; display-message "Selection copied."

# redraw the client (if interrupted by wall, etc)
bind R refresh-client

# r : reload tmux config
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display "Reloaded tmux config."

# Ctr+k : clear scrollback buffer
unbind C-k
bind -n C-k send-keys -R \; send-keys C-l \; clear-history

# \ (pipe key) : vertical split
unbind '\'
bind-key '\' split-window -h

# \ (pipe key) : vertical split
unbind |
bind-key | split-window -h

# - : horizontal split
unbind -
bind-key - split-window

# [ctrl +t]/t : new window
unbind t
unbind C-t
bind-key t new-window
bind-key C-t new-window

# [ctrl+w]/w : kill pane
unbind w
unbind C-w
bind-key w kill-pane
bind-key C-w kill-pane

# n : new session
unbind n
unbind C-n
bind-key n new-session
bind-key C-n new-session

# [ctrl+h/ctrl+l] : cycle window
bind-key -r C-h select-window  -t :-
bind-key -r C-l select-window -t :+

# pane movement shortcuts
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# pane resize shortcuts
bind-key -r left resize-pane -L 10
bind-key -r down resize-pane -D 10
bind-key -r up resize-pane -U 10
bind-key -r right resize-pane -R 10

###############################################################
# Status Line
###############################################################

# enable the status line
set -g status on

# set refresh interval for updating the status line
set -g status-interval 60

# set status line alignment
set -g status-justify left

# define pane border colors
set -g pane-border-style "bg=black,fg=black"
set -g pane-active-border-style "bg=black,fg=blue"

# define pane identifier colors
set -g display-panes-colour black
set -g display-panes-active-colour brightblack

# define clock options
set -g clock-mode-colour cyan

# define message window colors
set -g message-style "bg=brightblack,fg=green,bold"
set -g message-command-style "bg=brightblack,fg=cyan"

# define mode colors
set -g mode-style "bg=yellow,fg=black,bold"

# define status line base colors
set-option -g status-style "bg=brightblack,fg=white"

# set max length of left status column
set-option -g status-left-length 40
# set information displayed to the left of the status line
set-option -g status-left " #S "

# set the format for displaying windows
set-option -w -g window-status-format " #I | #W #F "
# set the format for the current window
set-option -w -g window-status-current-format " #I | #W #F "
# set character used to separate the window list
set-option -w -g window-status-separator ""

# set information displayed to the right of the status line
set-option -g status-right "#[bg=#8a8a8a,fg=#404040] %l:%M %p #[bg=#505050,fg=#909090] #(echo #h | awk '{print tolower($0)}') "

# set status line for windows with an acitivity alert
set-option -w -g window-status-activity-style "bg=yellow,fg=#373737,bold"
# set status line for windows with a bell alert
set-option -w -g window-status-bell-style "bg=red,fg=#373737,bold"
# define the window list colors
set-option -w -g window-status-style "fg=#bebebe"
# set status line for the current window
set-option -w -g window-status-current-style "bg=#2e2e2f,fg=#bebebe,bold"
